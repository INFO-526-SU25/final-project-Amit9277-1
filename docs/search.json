[
  {
    "objectID": "Q2_code.html",
    "href": "Q2_code.html",
    "title": "Q2_code",
    "section": "",
    "text": "## install.packages(\"tidytuesdayR\")\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(forcats)\nlibrary(dplyr)\nlibrary(patchwork)\n\n\ntuesdata &lt;- tidytuesdayR::tt_load('2025-01-21')\n\n#Although our two questions only use exped_tidy, we have added code to make a separate peaks_tidy in case we find out that we need variables from that dataframe later on.\n\nexped_tidy &lt;- tuesdata$exped_tidy\n#peaks_tidy &lt;- tuesdata$peaks_tidy\n\nexped_tidy &lt;- clean_names(exped_tidy)\n#peaks_tidy &lt;- clean_names(peaks_tidy)\n\nhead(exped_tidy, n=10)\n\n# A tibble: 10 × 69\n   expid     peakid  year season season_factor  host host_factor route1   route2\n   &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt; \n 1 EVER20101 EVER    2020      1 Spring            2 China       N Col-N… &lt;NA&gt;  \n 2 EVER20102 EVER    2020      1 Spring            2 China       N Col-N… &lt;NA&gt;  \n 3 EVER20103 EVER    2020      1 Spring            2 China       N Col-N… &lt;NA&gt;  \n 4 AMAD20301 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 5 AMAD20302 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 6 AMAD20303 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 7 AMAD20304 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 8 AMAD20305 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 9 AMAD20306 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n10 AMAD20307 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n# ℹ 60 more variables: route3 &lt;lgl&gt;, route4 &lt;lgl&gt;, nation &lt;chr&gt;, leaders &lt;chr&gt;,\n#   sponsor &lt;chr&gt;, success1 &lt;lgl&gt;, success2 &lt;lgl&gt;, success3 &lt;lgl&gt;,\n#   success4 &lt;lgl&gt;, ascent1 &lt;chr&gt;, ascent2 &lt;chr&gt;, ascent3 &lt;lgl&gt;, ascent4 &lt;lgl&gt;,\n#   claimed &lt;lgl&gt;, disputed &lt;lgl&gt;, countries &lt;chr&gt;, approach &lt;chr&gt;,\n#   bcdate &lt;date&gt;, smtdate &lt;date&gt;, smttime &lt;chr&gt;, smtdays &lt;dbl&gt;, totdays &lt;dbl&gt;,\n#   termdate &lt;date&gt;, termreason &lt;dbl&gt;, termreason_factor &lt;chr&gt;, termnote &lt;chr&gt;,\n#   highpoint &lt;dbl&gt;, traverse &lt;lgl&gt;, ski &lt;lgl&gt;, parapente &lt;lgl&gt;, camps &lt;dbl&gt;, …\n\n#head(peaks_tidy, n=10)\n\n\nexped_tidy &lt;- exped_tidy |&gt;\n  mutate(\n    \"pmdeaths\" = mdeaths/totmembers,\n    \"phdeaths\" = hdeaths/tothired,\n    \"totdeaths\" = (hdeaths+ mdeaths),\n    \"ptotdeaths\" = totdeaths/(tothired + totmembers)\n  )\nexped_tidy_deadly &lt;- exped_tidy |&gt;\n  filter(pmdeaths &gt; 0 | phdeaths &gt; 0) |&gt;\n  filter(!is.na(agency))\nexped_tidy_deadly &lt;- exped_tidy_deadly |&gt;\n  select(year, season_factor, host_factor, nation, agency, totmembers, smtmembers, mdeaths, tothired, hdeaths, totdeaths, pmdeaths, phdeaths, ptotdeaths)\nexped_tidy_deadly\n\n# A tibble: 37 × 14\n    year season_factor host_factor nation agency   totmembers smtmembers mdeaths\n   &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;\n 1  2021 Spring        Nepal       USA    TAGnepa…         35         10       0\n 2  2021 Spring        Nepal       Russia 7 Summi…         15          7       0\n 3  2021 Spring        Nepal       India  Seven S…         37         22       2\n 4  2021 Spring        Nepal       China  Seven S…         13          9       0\n 5  2021 Autumn        Nepal       Nepal  TAGnepa…          5          0       1\n 6  2021 Autumn        Nepal       France Pralhad…          4          0       3\n 7  2022 Spring        Nepal       Greece Seven S…          7          3       1\n 8  2022 Spring        Nepal       USA    Beyul A…         10          8       0\n 9  2022 Spring        Nepal       Russia 7 Summi…         15         12       1\n10  2022 Spring        Nepal       Nepal  High Fi…          7          6       1\n# ℹ 27 more rows\n# ℹ 6 more variables: tothired &lt;dbl&gt;, hdeaths &lt;dbl&gt;, totdeaths &lt;dbl&gt;,\n#   pmdeaths &lt;dbl&gt;, phdeaths &lt;dbl&gt;, ptotdeaths &lt;dbl&gt;\n\n\n\ndeadly_agencies &lt;- unique(exped_tidy_deadly$agency)\nnon_deadly &lt;- exped_tidy |&gt;\n  filter(!agency %in% deadly_agencies)\nnon_deadly_agencies &lt;- unique(non_deadly$agency)\nlength(non_deadly_agencies)\n\n[1] 160\n\nlength(deadly_agencies)\n\n[1] 22\n\n\n\nexped_tidy_deadly |&gt;\n  ggplot(aes(x = fct_rev(fct_infreq(agency)), fill = after_stat(count))) +\n  geom_bar() +\n  coord_flip() +\n  scale_y_continuous(breaks = c(0, 2, 4, 6, 8, 10)) +\n  scale_fill_gradient(low = \"#ffce00\", high = \"darkred\") +\n  labs(\n    title = \"Number of expeditions through the Himalayas \\nthat resulted in death by Agency\",\n    subtitle = \"from 2021 - 2024\",\n    caption = \"Source: Tidytuesday\",\n    x = NULL,\n    y = \"Number of expeditions that resulted in at least one death\",\n    fill = NULL\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    panel.grid.minor = element_blank(),\n    panel.grid.major.y = element_blank()\n  )\n\n\n\n\n\n\n\n\n\ndeaths_2021 &lt;- exped_tidy_deadly |&gt;\n  filter(year == 2021)\ndeaths_2021\n\n# A tibble: 6 × 14\n   year season_factor host_factor nation agency    totmembers smtmembers mdeaths\n  &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;\n1  2021 Spring        Nepal       USA    TAGnepal…         35         10       0\n2  2021 Spring        Nepal       Russia 7 Summit…         15          7       0\n3  2021 Spring        Nepal       India  Seven Su…         37         22       2\n4  2021 Spring        Nepal       China  Seven Su…         13          9       0\n5  2021 Autumn        Nepal       Nepal  TAGnepal…          5          0       1\n6  2021 Autumn        Nepal       France Pralhad …          4          0       3\n# ℹ 6 more variables: tothired &lt;dbl&gt;, hdeaths &lt;dbl&gt;, totdeaths &lt;dbl&gt;,\n#   pmdeaths &lt;dbl&gt;, phdeaths &lt;dbl&gt;, ptotdeaths &lt;dbl&gt;\n\ndeaths_2021_av &lt;- deaths_2021 %&gt;%\n  group_by(agency, season_factor) %&gt;%\n  summarise(avg_ptotdeaths = mean(ptotdeaths, na.rm = TRUE),\n            .groups = \"drop\")\ndeaths_2021_av\n\n# A tibble: 5 × 3\n  agency                                      season_factor avg_ptotdeaths\n  &lt;chr&gt;                                       &lt;chr&gt;                  &lt;dbl&gt;\n1 7 Summits Adventure                         Spring                0.0222\n2 Pralhad Chapagain (Freelancer at Expes.com) Autumn                0.75  \n3 Seven Summit Treks                          Spring                0.0356\n4 TAGnepal Trekking                           Spring                0.0118\n5 TAGnepal Trekking (Snowy Horizon pmt)       Autumn                0.111 \n\ndeaths_2021_raw &lt;- deaths_2021 |&gt;\n  group_by(agency, season_factor) %&gt;%\n  summarize(total_deaths = sum(totdeaths), .groups = \"drop\")\ndeaths_2021_raw\n\n# A tibble: 5 × 3\n  agency                                      season_factor total_deaths\n  &lt;chr&gt;                                       &lt;chr&gt;                &lt;dbl&gt;\n1 7 Summits Adventure                         Spring                   1\n2 Pralhad Chapagain (Freelancer at Expes.com) Autumn                   3\n3 Seven Summit Treks                          Spring                   3\n4 TAGnepal Trekking                           Spring                   1\n5 TAGnepal Trekking (Snowy Horizon pmt)       Autumn                   1\n\n\n\ndeaths_2021_av |&gt;\n  ggplot(aes(x = fct_reorder(agency, avg_ptotdeaths, .desc = FALSE), y = avg_ptotdeaths, fill = season_factor)) +\n  geom_col() +\n  coord_flip(ylim = c(0, 1)) +\n  scale_fill_manual(values = c(\"orange\", \"lightgreen\")) +\n  labs(\n    fill = \"Season\",\n    x = \"Trekking Agency\",\n    y = \"Total Death\",\n    title = \"Percent total deaths by Agency in 2021\",\n    caption = \"Source: TidyTuesday\",\n    subtitle = \"M is trekking member death, H is hired staff death\"\n  ) +\n  scale_y_continuous(\n    breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1),\n    labels = c(\"0%\", \"20%\", \"40%\", \"60%\", \"80%\", \"100%\")\n  ) +\n  annotate(\"text\", y = 0.2, x = 1, label = \"M 6.6%\") +\n  annotate(\"text\", y = 0.2, x = 2, label = \"H 3.3%\") +\n  annotate(\"text\", y = 0.3, x = 3, label = \"Trek 1: M 54%\") +\n  annotate(\"text\", y = 0.7, x = 3, label = \"Trek 2: H 10%\") +\n  annotate(\"text\", y = 0.3, x = 4, label = \"M 20%\") +\n  annotate(\"text\", y = 0.4, x = 5, label = \"M 75%\") +\n  theme_minimal() +\n  theme(\n    axis.ticks.x = element_blank(),\n    panel.grid = element_blank()\n  )\n\n\ndeaths_2021_raw |&gt;\n  ggplot(aes(x = fct_reorder(agency, total_deaths, .desc = FALSE), y = total_deaths, fill = season_factor)) +\n  geom_col() +\n  coord_flip(ylim = c(0, 5)) +\n  scale_fill_manual(values = c(\"orange\", \"lightgreen\")) +\n  labs(\n    fill = \"Season\",\n    x = \"Trekking Agency\",\n    y = \"Total Deaths\",\n    title = \"Percent total deaths by Agency in 2021\",\n    caption = \"Source: TidyTuesday\",\n    subtitle = \"M is trekking member death, H is hired staff death\"\n  ) +\n  scale_y_continuous(\n    breaks = c(0, 1, 2, 3, 4, 5)\n  ) +\n  #annotate(\"text\", y = 2, x = 3, label = \"M 1\") +\n  #annotate(\"text\", y = 2, x = 2, label = \"H 1\") +\n  #annotate(\"text\", y = 2, x = 1, label = \"Trek 1: M 2\") +\n  #annotate(\"text\", y = 4, x = 1, label = \"Trek 2: H 1\") +\n  #annotate(\"text\", y = 4, x = 4, label = \"M 3\") +\n  #annotate(\"text\", y = 4, x = 5, label = \"M 3\") +\n  annotate(\"text\", y = 4, x = 5, label = \"Total Treks: 2\") +\n  theme_minimal() +\n  theme(\n    axis.ticks.x = element_blank(),\n    panel.grid = element_blank()\n  )\n\n\n\n\n\n\n\n\n\ndeaths_2022 &lt;- exped_tidy_deadly |&gt;\n  filter(year == 2022)\ndeaths_2022\n\n# A tibble: 10 × 14\n    year season_factor host_factor nation   agency totmembers smtmembers mdeaths\n   &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;\n 1  2022 Spring        Nepal       Greece   Seven…          7          3       1\n 2  2022 Spring        Nepal       USA      Beyul…         10          8       0\n 3  2022 Spring        Nepal       Russia   7 Sum…         15         12       1\n 4  2022 Spring        Nepal       Nepal    High …          7          6       1\n 5  2022 Spring        Nepal       Nepal    Pione…         13          9       1\n 6  2022 Spring        Nepal       S Korea  Seven…          8          0       0\n 7  2022 Autumn        Nepal       Georgia  Sator…         16         12       1\n 8  2022 Autumn        Nepal       Netherl… Seven…         15          0       0\n 9  2022 Autumn        Nepal       USA      Shang…          5          2       1\n10  2022 Autumn        Nepal       USA      Sator…         10          0       0\n# ℹ 6 more variables: tothired &lt;dbl&gt;, hdeaths &lt;dbl&gt;, totdeaths &lt;dbl&gt;,\n#   pmdeaths &lt;dbl&gt;, phdeaths &lt;dbl&gt;, ptotdeaths &lt;dbl&gt;\n\ndeaths_2022_av &lt;- deaths_2022 %&gt;%\n  group_by(agency, season_factor) %&gt;%\n  summarise(avg_ptotdeaths = mean(ptotdeaths, na.rm = TRUE),\n            .groups = \"drop\")\ndeaths_2022_av\n\n# A tibble: 8 × 3\n  agency                                        season_factor avg_ptotdeaths\n  &lt;chr&gt;                                         &lt;chr&gt;                  &lt;dbl&gt;\n1 7 Summits Adventure                           Spring                0.0263\n2 Beyul Adventure                               Spring                0.0323\n3 High Five Adventures (Pioneer Adventures pmt) Spring                0.1   \n4 Pioneer Adventure                             Spring                0.0333\n5 Satori Adventures                             Autumn                0.0406\n6 Seven Summit Treks                            Autumn                0.0333\n7 Seven Summit Treks                            Spring                0.0565\n8 Shangri-La Nepal Treks                        Autumn                0.0833\n\ndeaths_2022_raw &lt;- deaths_2022 |&gt;\n  group_by(agency, season_factor) %&gt;%\n  summarize(total_deaths = sum(totdeaths), .groups = \"drop\")\ndeaths_2022_raw\n\n# A tibble: 8 × 3\n  agency                                        season_factor total_deaths\n  &lt;chr&gt;                                         &lt;chr&gt;                &lt;dbl&gt;\n1 7 Summits Adventure                           Spring                   1\n2 Beyul Adventure                               Spring                   1\n3 High Five Adventures (Pioneer Adventures pmt) Spring                   1\n4 Pioneer Adventure                             Spring                   1\n5 Satori Adventures                             Autumn                   2\n6 Seven Summit Treks                            Autumn                   1\n7 Seven Summit Treks                            Spring                   2\n8 Shangri-La Nepal Treks                        Autumn                   1\n\n\n\npercent_2022 &lt;- deaths_2022_av |&gt;\n  ggplot(aes(x = fct_reorder(agency, avg_ptotdeaths, .desc = FALSE), y = avg_ptotdeaths, fill = season_factor)) +\n  geom_col() +\n  coord_flip(ylim = c(0, 1)) +\n  scale_fill_manual(values = c(\"orange\", \"lightgreen\")) +\n  labs(\n    fill = \"Season\",\n    x = \"Trekking Agency\",\n    y = \"Total Percent Death (Average)\",\n    title = \"Percent total deaths by Agency in 2022\",\n    caption = \"Source: TidyTuesday\",\n    subtitle = \"M is trekking member death, H is hired staff death\"\n  ) +\n  scale_y_continuous(\n    breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1),\n    labels = c(\"0%\", \"20%\", \"40%\", \"60%\", \"80%\", \"100%\")\n  ) +\n  annotate(\"text\", y = 0.2, x = 1, label = \"H 20%\") +\n  annotate(\"text\", y = 0.2, x = 2, label = \"H 4.7%\") +\n  annotate(\"text\", y = 0.2, x = 3, label = \"M 7.6%\") +\n  annotate(\"text\", y = 0.3, x = 4, label = \"Trek 1: M 6.25%\") +\n  annotate(\"text\", y = 0.7, x = 4, label = \"Trek 2: H 10%\") +\n  annotate(\"text\", y = 0.32, x = 4.8, label = \"Trek 1: M 14.2%\") +\n  annotate(\"text\", y = 0.32, x = 5.2, label = \"Trek 2: H 6.25%\") +\n  annotate(\"text\", y = 0.8, x = 5, label = \"Trek 3: H 6.67%\") +\n  annotate(\"text\", y = 0.25, x = 6, label = \"M 20%\") +\n  annotate(\"text\", y = 0.3, x = 7, label = \"M 14.28%\") +\n  theme_minimal() +\n  theme(\n    axis.ticks.x = element_blank(),\n    panel.grid = element_blank()\n  )\n\n\nraw_2022 &lt;- deaths_2022_raw |&gt;\n  ggplot(aes(x = fct_reorder(agency, total_deaths, .desc = FALSE), y = total_deaths, fill = season_factor)) +\n  geom_col() +\n  coord_flip(ylim = c(0, 5)) +\n  scale_fill_manual(values = c(\"orange\", \"lightgreen\")) +\n  labs(\n    fill = \"Season\",\n    x = \"Trekking Agency\",\n    y = \"Total Percent Death (Average)\",\n    title = \"Percent total deaths by Agency in 2022\",\n    caption = \"Source: TidyTuesday\",\n    subtitle = \"M is trekking member death, H is hired staff death\"\n  ) +\n  scale_y_continuous(\n    breaks = c(0, 1, 2, 3, 4, 5)\n  ) +\n  #annotate(\"text\", y = 2, x = 1, label = \"M 1\") +\n  #annotate(\"text\", y = 2, x = 2, label = \"H 1\") +\n  #annotate(\"text\", y = 2, x = 3, label = \"M 1\") +\n  #annotate(\"text\", y = 2, x = 4, label = \"M 1\") +\n  #annotate(\"text\", y = 2, x = 5, label = \"M 1\") +\n  #annotate(\"text\", y = 1, x = 6, label = \"Trek 1: M 1\") +\n  #annotate(\"text\", y = 2.7, x = 6, label = \"Trek 2: H 1\") +\n  #annotate(\"text\", y = 4.5, x = 6, label = \"Trek 3: H 1\") +\n  #annotate(\"text\", y = 1, x = 7, label = \"Trek 1: M 1\") +\n  #annotate(\"text\", y = 3, x = 7, label = \"Trek 2: H 1\") +\n  annotate(\"text\", y = 4, x = 6, label = \"Total Treks: 3\") +\n  annotate(\"text\", y = 3, x = 7, label = \"Total Treks: 2\") +\n  theme_minimal() +\n  theme(\n    axis.ticks.x = element_blank(),\n    panel.grid = element_blank()\n  )\n\n\ndeaths_2023 &lt;- exped_tidy_deadly |&gt;\n  filter(year == 2023)\ndeaths_2023\n\n# A tibble: 15 × 14\n    year season_factor host_factor nation   agency totmembers smtmembers mdeaths\n   &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;\n 1  2023 Spring        Nepal       Pakistan Seven…         21         12       1\n 2  2023 Spring        Nepal       Nepal    Imagi…         15         10       0\n 3  2023 Spring        Nepal       USA      Beyul…          6          3       1\n 4  2023 Spring        Nepal       USA      Himal…         19         12       1\n 5  2023 Spring        Nepal       Nepal    Asian…         13         10       2\n 6  2023 Spring        Nepal       China    8K Ex…         17          6       1\n 7  2023 Spring        Nepal       Denmark  Seven…         30         14       2\n 8  2023 Spring        Nepal       India    Pione…         15          6       2\n 9  2023 Spring        Nepal       Vietnam  Exped…         10          3       1\n10  2023 Spring        Nepal       France   Glaci…          5          1       1\n11  2023 Spring        Nepal       Nepal    Annap…          1          0       1\n12  2023 Spring        Nepal       Nepal    Peak …          8          5       0\n13  2023 Spring        Nepal       Germany  Seven…         16          8       1\n14  2023 Autumn        Nepal       Czech R… 14 Su…          6          2       1\n15  2023 Autumn        Nepal       Russia   Himal…          3          0       1\n# ℹ 6 more variables: tothired &lt;dbl&gt;, hdeaths &lt;dbl&gt;, totdeaths &lt;dbl&gt;,\n#   pmdeaths &lt;dbl&gt;, phdeaths &lt;dbl&gt;, ptotdeaths &lt;dbl&gt;\n\ndeaths_2023_av &lt;- deaths_2023 %&gt;%\n  group_by(agency, season_factor) %&gt;%\n  summarise(avg_ptotdeaths = mean(ptotdeaths, na.rm = TRUE),\n            .groups = \"drop\")\ndeaths_2023_av\n\n# A tibble: 13 × 3\n   agency                 season_factor avg_ptotdeaths\n   &lt;chr&gt;                  &lt;chr&gt;                  &lt;dbl&gt;\n 1 14 Summits             Autumn                0.167 \n 2 8K Expeditions         Spring                0.0270\n 3 Annapurna Treks        Spring                1     \n 4 Asian Trekking         Spring                0.05  \n 5 Beyul Adventure        Spring                0.0476\n 6 Expedition Himalaya    Spring                0.0333\n 7 Glacier Himalaya Treks Spring                0.1   \n 8 Himalayan Guides       Autumn                0.333 \n 9 Himalayan Guides       Spring                0.0204\n10 Imagine Nepal          Spring                0.0667\n11 Peak Promotion         Spring                0.125 \n12 Pioneer Adventure      Spring                0.0667\n13 Seven Summit Treks     Spring                0.0281\n\ndeaths_2023_raw &lt;- deaths_2023 |&gt;\n  group_by(agency, season_factor) %&gt;%\n  summarize(total_deaths = sum(totdeaths), .groups = \"drop\")\ndeaths_2023_raw\n\n# A tibble: 13 × 3\n   agency                 season_factor total_deaths\n   &lt;chr&gt;                  &lt;chr&gt;                &lt;dbl&gt;\n 1 14 Summits             Autumn                   1\n 2 8K Expeditions         Spring                   1\n 3 Annapurna Treks        Spring                   2\n 4 Asian Trekking         Spring                   2\n 5 Beyul Adventure        Spring                   1\n 6 Expedition Himalaya    Spring                   1\n 7 Glacier Himalaya Treks Spring                   1\n 8 Himalayan Guides       Autumn                   1\n 9 Himalayan Guides       Spring                   1\n10 Imagine Nepal          Spring                   3\n11 Peak Promotion         Spring                   2\n12 Pioneer Adventure      Spring                   2\n13 Seven Summit Treks     Spring                   4\n\n\n\npercent_2023 &lt;- deaths_2023_av |&gt;\n  ggplot(aes(x = fct_reorder(agency, avg_ptotdeaths, .desc = FALSE), y = avg_ptotdeaths, fill = season_factor)) +\n  geom_col() +\n  coord_flip(ylim = c(0, 1)) +\n  scale_fill_manual(values = c(\"orange\", \"lightgreen\")) +\n  labs(\n    fill = \"Season\",\n    x = \"Trekking Agency\",\n    y = \"Total Percent Death (Average)\",\n    title = \"Percent total deaths by Agency in 2023\",\n    caption = \"Source: TidyTuesday\",\n    subtitle = \"M is trekking member death, H is hired staff death\"\n  ) +\n  scale_y_continuous(\n    breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1),\n    labels = c(\"0%\", \"20%\", \"40%\", \"60%\", \"80%\", \"100%\")\n  ) +\n  annotate(\"text\", y = 0.2, x = 1, label = \"M 5.8%\") +\n  annotate(\"text\", y = 0.2, x = 2, label = \"Trek 1: M 4.7%\") +\n  annotate(\"text\", y = 0.5, x = 2, label = \"Trek 2: M 6.7%\") +\n  annotate(\"text\", y = 0.8, x = 2, label = \"Trek 3: 6.3%\") +\n  annotate(\"text\", y = 0.2, x = 3, label = \"M 10%\") +\n  annotate(\"text\", y = 0.2, x = 4, label = \"M 1.66%\") +\n  annotate(\"text\", y = 0.2, x = 5, label = \"M 15.3%\") +\n  annotate(\"text\", y = 0.2, x = 6, label = \"H 10%\") +\n  annotate(\"text\", y = 0.2, x = 7, label = \"M 13.3%\") +\n  annotate(\"text\", y = 0.2, x = 8, label = \"M 20%\") +\n  annotate(\"text\", y = 0.23, x = 9, label = \"H 25%\") +\n  annotate(\"text\", y = 0.25, x = 10, label = \"M 16.7%\") +\n  annotate(\"text\", y = 0.5, x = 11, label = \"Trek 1: M 5.3%\") +\n  annotate(\"text\", y = 0.8, x = 11, label = \"Trek 2: M 33.3%\") +\n  annotate(\"text\", y = 0.5, x = 12, label = \"M 100%\") +\n  theme_minimal() +\n  theme(\n    axis.ticks.x = element_blank(),\n    panel.grid = element_blank()\n  )\n\n\nraw_2023 &lt;- deaths_2023_raw |&gt;\n  ggplot(aes(x = fct_reorder(agency, total_deaths, .desc = FALSE), y = total_deaths, fill = season_factor)) +\n  geom_col() +\n  coord_flip(ylim = c(0, 5)) +\n  scale_fill_manual(values = c(\"orange\", \"lightgreen\")) +\n  labs(\n    fill = \"Season\",\n    x = \"Trekking Agency\",\n    y = \"Total Death\",\n    title = \"Total deaths by Agency in 2023\",\n    caption = \"Source: TidyTuesday\",\n    subtitle = \"M is trekking member death, H is hired staff death\"\n  ) +\n  scale_y_continuous(\n    breaks = c(0, 1, 2, 3, 4, 5)\n  ) +\n  annotate(\"text\", y = 3, x = 6, label = \"Total Treks: 2\") +\n  annotate(\"text\", y = 3, x = 12, label = \"Total Treks: 3\") +\n  theme_minimal() +\n  theme(\n    axis.ticks.x = element_blank(),\n    panel.grid = element_blank()\n  )\n\n\ndeaths_2024 &lt;- exped_tidy_deadly |&gt;\n  filter(year == 2024)\ndeaths_2024\n\n# A tibble: 6 × 14\n   year season_factor host_factor nation  agency   totmembers smtmembers mdeaths\n  &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;\n1  2024 Spring        Nepal       Italy   Seven S…         22         12       1\n2  2024 Spring        Nepal       Ukraine 8K Expe…         36         29       4\n3  2024 Spring        Nepal       Nepal   Yeti Ad…          2          1       1\n4  2024 Spring        Nepal       UK      Makalu …         15          7       1\n5  2024 Spring        Nepal       Nepal   Seven S…         27         15       0\n6  2024 Spring        Nepal       France  Snowy H…         10          5       1\n# ℹ 6 more variables: tothired &lt;dbl&gt;, hdeaths &lt;dbl&gt;, totdeaths &lt;dbl&gt;,\n#   pmdeaths &lt;dbl&gt;, phdeaths &lt;dbl&gt;, ptotdeaths &lt;dbl&gt;\n\ndeaths_2024_av &lt;- deaths_2024 %&gt;%\n  group_by(agency, season_factor) %&gt;%\n  summarise(avg_ptotdeaths = mean(ptotdeaths, na.rm = TRUE),\n            .groups = \"drop\")\ndeaths_2024_av\n\n# A tibble: 5 × 3\n  agency              season_factor avg_ptotdeaths\n  &lt;chr&gt;               &lt;chr&gt;                  &lt;dbl&gt;\n1 8K Expeditions      Spring                0.0581\n2 Makalu Adventure    Spring                0.0333\n3 Seven Summit Treks  Spring                0.0279\n4 Snowy Horizon Treks Spring                0.0370\n5 Yeti Adventure      Spring                0.333 \n\ndeaths_2024_raw &lt;- deaths_2024 |&gt;\n  group_by(agency, season_factor) %&gt;%\n  summarize(total_deaths = sum(totdeaths), .groups = \"drop\")\ndeaths_2024_raw\n\n# A tibble: 5 × 3\n  agency              season_factor total_deaths\n  &lt;chr&gt;               &lt;chr&gt;                &lt;dbl&gt;\n1 8K Expeditions      Spring                   5\n2 Makalu Adventure    Spring                   1\n3 Seven Summit Treks  Spring                   3\n4 Snowy Horizon Treks Spring                   1\n5 Yeti Adventure      Spring                   1\n\n\n\npercent_2024 &lt;- deaths_2024_av |&gt;\n  ggplot(aes(x = fct_reorder(agency, avg_ptotdeaths, .desc = FALSE), y = avg_ptotdeaths, fill = season_factor)) +\n  geom_col() +\n  coord_flip(ylim = c(0, 1)) +\n  scale_fill_manual(values = \"lightgreen\") +\n  labs(\n    fill = \"Season\",\n    x = \"Trekking Agency\",\n    y = \"Total Percent Death (Average)\",\n    title = \"Percent total deaths by Agency in 2024\",\n    caption = \"Source: TidyTuesday\",\n    subtitle = \"M is trekking member death, H is hired staff death\"\n  ) +\n  scale_y_continuous(\n    breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1),\n    labels = c(\"0%\", \"20%\", \"40%\", \"60%\", \"80%\", \"100%\")\n  ) +\n  annotate(\"text\", y = 0.2, x = 2, label = \"M 6.7%\") +\n  annotate(\"text\", y = 0.3, x = 1, label = \"Trek 1: M 4.5% H 3.3%\") +\n  annotate(\"text\", y = 0.7, x = 1, label = \"Trek 2: H 3.2%\") +\n  annotate(\"text\", y = 0.2, x = 3, label = \"M 10%\") +\n  annotate(\"text\", y = 0.2, x = 4, label = \"M 11.1% H 2%\") +\n  annotate(\"text\", y = 0.5, x = 5, label = \"M 50%\") +\n  theme_minimal() +\n  theme(\n    axis.ticks.x = element_blank(),\n    panel.grid = element_blank()\n  )\npercent_2024\n\n\n\n\n\n\n\n\n\nraw_2024 &lt;- deaths_2024_raw |&gt;\n  ggplot(aes(x = fct_reorder(agency, total_deaths, .desc = FALSE), y = total_deaths, fill = season_factor)) +\n  geom_col() +\n  coord_flip(ylim = c(0, 5)) +\n  scale_fill_manual(values = c(\"lightgreen\")) +\n  labs(\n    fill = \"Season\",\n    x = \"Trekking Agency\",\n    y = \"Total Death\",\n    title = \"Total deaths by Agency in 2024\",\n    caption = \"Source: TidyTuesday\",\n    subtitle = \"M is trekking member death, H is hired staff death\"\n  ) +\n  scale_y_continuous(\n    breaks = c(0, 1, 2, 3, 4, 5)\n  ) +\n  annotate(\"text\", y = 4, x = 4, label = \"Total Treks: 2\") +\n  theme_minimal() +\n  theme(\n    axis.ticks.x = element_blank(),\n    panel.grid = element_blank()\n  )\nraw_2024\n\n\n\n\n\n\n\n\n\n#final_2021 &lt;- (percent_2021 + raw_2021)\n#final_2021"
  },
  {
    "objectID": "proposal.html",
    "href": "proposal.html",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "",
    "text": "## install.packages(\"tidytuesdayR\")\nlibrary(tidyverse)\nlibrary(janitor)"
  },
  {
    "objectID": "proposal.html#dataset",
    "href": "proposal.html#dataset",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Dataset",
    "text": "Dataset\n\ntuesdata &lt;- tidytuesdayR::tt_load('2025-01-21')\n\n#Although our two questions only use exped_tidy, we have added code to make a separate peaks_tidy in case we find out that we need variables from that dataframe later on.\n\nexped_tidy &lt;- tuesdata$exped_tidy\npeaks_tidy &lt;- tuesdata$peaks_tidy\n\nexped_tidy &lt;- clean_names(exped_tidy)\npeaks_tidy &lt;- clean_names(peaks_tidy)\n\nhead(exped_tidy, n=10)\n\n# A tibble: 10 × 69\n   expid     peakid  year season season_factor  host host_factor route1   route2\n   &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt; \n 1 EVER20101 EVER    2020      1 Spring            2 China       N Col-N… &lt;NA&gt;  \n 2 EVER20102 EVER    2020      1 Spring            2 China       N Col-N… &lt;NA&gt;  \n 3 EVER20103 EVER    2020      1 Spring            2 China       N Col-N… &lt;NA&gt;  \n 4 AMAD20301 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 5 AMAD20302 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 6 AMAD20303 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 7 AMAD20304 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 8 AMAD20305 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n 9 AMAD20306 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n10 AMAD20307 AMAD    2020      3 Autumn            1 Nepal       SW Ridge &lt;NA&gt;  \n# ℹ 60 more variables: route3 &lt;lgl&gt;, route4 &lt;lgl&gt;, nation &lt;chr&gt;, leaders &lt;chr&gt;,\n#   sponsor &lt;chr&gt;, success1 &lt;lgl&gt;, success2 &lt;lgl&gt;, success3 &lt;lgl&gt;,\n#   success4 &lt;lgl&gt;, ascent1 &lt;chr&gt;, ascent2 &lt;chr&gt;, ascent3 &lt;lgl&gt;, ascent4 &lt;lgl&gt;,\n#   claimed &lt;lgl&gt;, disputed &lt;lgl&gt;, countries &lt;chr&gt;, approach &lt;chr&gt;,\n#   bcdate &lt;date&gt;, smtdate &lt;date&gt;, smttime &lt;chr&gt;, smtdays &lt;dbl&gt;, totdays &lt;dbl&gt;,\n#   termdate &lt;date&gt;, termreason &lt;dbl&gt;, termreason_factor &lt;chr&gt;, termnote &lt;chr&gt;,\n#   highpoint &lt;dbl&gt;, traverse &lt;lgl&gt;, ski &lt;lgl&gt;, parapente &lt;lgl&gt;, camps &lt;dbl&gt;, …\n\nhead(peaks_tidy, n=10)\n\n# A tibble: 10 × 29\n   peakid pkname      pkname2 location heightm heightf himal himal_factor region\n   &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;\n 1 AMAD   Ama Dablam  Amai D… Khumbu …    6814   22356    12 Khumbu            2\n 2 AMPG   Amphu Gyab… Amphu … Khumbu …    5630   18471    12 Khumbu            2\n 3 ANN1   Annapurna I &lt;NA&gt;    Annapur…    8091   26545     1 Annapurna         5\n 4 ANN2   Annapurna … &lt;NA&gt;    Annapur…    7937   26040     1 Annapurna         5\n 5 ANN3   Annapurna … &lt;NA&gt;    Annapur…    7555   24787     1 Annapurna         5\n 6 ANN4   Annapurna … &lt;NA&gt;    Annapur…    7525   24688     1 Annapurna         5\n 7 ANNE   Annapurna … &lt;NA&gt;    Annapur…    8026   26332     1 Annapurna         5\n 8 ANNM   Annapurna … &lt;NA&gt;    Annapur…    8051   26414     1 Annapurna         5\n 9 ANNS   Annapurna … Annapu… Annapur…    7219   23684     1 Annapurna         5\n10 APIM   Api Main    &lt;NA&gt;    Api Him…    7132   23399     2 Api/Byas Ri…      7\n# ℹ 20 more variables: region_factor &lt;chr&gt;, open &lt;lgl&gt;, unlisted &lt;lgl&gt;,\n#   trekking &lt;lgl&gt;, trekyear &lt;dbl&gt;, restrict &lt;chr&gt;, phost &lt;dbl&gt;,\n#   phost_factor &lt;chr&gt;, pstatus &lt;dbl&gt;, pstatus_factor &lt;chr&gt;, peakmemo &lt;dbl&gt;,\n#   pyear &lt;dbl&gt;, pseason &lt;dbl&gt;, pexpid &lt;chr&gt;, psmtdate &lt;chr&gt;, pcountry &lt;chr&gt;,\n#   psummiters &lt;chr&gt;, psmtnote &lt;chr&gt;, refermemo &lt;dbl&gt;, photomemo &lt;dbl&gt;\n\nwrite.csv(exped_tidy, \"data/exped_tidy.csv\")\nwrite.csv(peaks_tidy, \"data/peaks_tidy.csv\")\n\nWe chose this dataset because not only did our team find the prospect of analyzing Himalayan mountaineering expeditions to be incredibly interesting, but also because the dataset contained a good balance between qualitative and quantitative data, with a variety of different data types (character, integer, date, logical, etc.). The large amount of time data inspired us to think about potential time series visualizations and the variables present allowed for diverse questions from analysis of lethality to the impact of hiker background."
  },
  {
    "objectID": "proposal.html#questions",
    "href": "proposal.html#questions",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Questions",
    "text": "Questions\nQ1: Are certain routes favored by expeditions from particular nations, and do they have disparate success rates?\nQ2: Do certain Agencies have a higher number of member/personal deaths than others with respect to season/date?"
  },
  {
    "objectID": "proposal.html#analysis-plan",
    "href": "proposal.html#analysis-plan",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Analysis plan",
    "text": "Analysis plan\nData cleanup: after using clean_names(), we anticipate that data cleanup will only require ignoring NA values in the dataset.\n\nQ1 Plan:\nWe’ll first count, for each country, how many times each route was attempted and how many of those attempts succeeded. Then we’ll make a bar chart where:\n\nX-axis is the route name (categorical)\nY-axis is the number of attempts (numeric)\nBar fill shows the success rate (e.g. darker = higher percentage of summits)\n\nThis layout lets us instantly see which routes each country prefers (tallest bars) and how well they do on them (color intensity). We can then tweak—say, switch to a heatmap of nation vs. route with attempts as tile size and success rate as color—if we want another perspective.\nThe variables involved in this graph are as follows:\nExisting variables:\nnation (Categorical) - Principle nationality.\nroute1,…,route4 (Categorical) - Climbing route.\nsuccess1,….,success4 (Binary/Numeric) - Success on route.\nNew variables to be created:\nroute (categorical) - A single “long” route identifier created by pivoting route1–route4 into one column.\nsuccess (binary/numeric) - Corresponding to each route, the matching success flag (0 = fail, 1 = success).\nattempts (numeric) - Count of expeditions per (nation, route) pair.\nsuccess_rate (numeric, 0-1) - For each (nation, route):\n\\[\n\\text{success_rate} = \\frac{\\text{total successes}}{\\text{total attempts}}\n\\]\nThe approach to utilize the pivoted columns will be represent the routes bifurcation by individual peaks and then it will be plotted with correspondence to the success rate and number of attempts.\n\n\nQ2 Plan:\nWe anticipate that the best way to answer this question is to have a graph with percent total death by agency. These graphs will be faceted by season. To account for the difference in number of traveling done by season, we plan to adverage the percent death values. So far, a bar graph is the anticipated result though we are open to trying different types of graphs. If a bar graph is the final graph, we will use a stacked bar chart that shows what portion of the total death by agency is hiker or member deaths.\nThe variables involved in this graph are as follows:\nExisting variables:\n\nagency - Trekking agency\nmdeaths - Member deaths (per trip)\ntotmembers - total members (per trip)\nhdeaths - hired personnel deaths (per trip)\ntothired - total hired personnel (per trip)\nyear - year\nseason_factor - season\nNew variables to be created:\n\npmdeaths - mdeaths/totmembers - percent member deaths\nphdeaths -hdeaths/tothired -percent personnel deaths\nptotdeaths - (hdeaths+ mdeaths)/(tothired + totmembers ) - percent total deaths\nFor each season, we will annotate temperature and weather conditions which will be researched from internet sources. This may require a second graph that colors based on route. If this is the case, we will also require the variable: route1,…,route4"
  },
  {
    "objectID": "proposal.html#plan-of-attack",
    "href": "proposal.html#plan-of-attack",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Plan of Attack",
    "text": "Plan of Attack\n\n\n\n\n\n\n\n\n\n\n\nTask Name\nAssignee\nStatus\nDue\nPriority\nSummary\n\n\n\n\nPrepare Proposal\nCat & Amit\nDone\n2025-06-10\nHigh Priority\nCollaboratively select a dataset and define two research questions. Both will come-up with a question.\n\n\nProposal Peer Review\nCat & Amit\nDone\n2025-06-16*\nHigh Priority\nEach member will review one proposal from the assigned two proposal. Members will then review each others inputs and finalize it with mutual consent. Push the final review to respective repository as issue.\n\n\nProposal Peer Review Edits\nCat\nDone\n2025-06-18\nHigh Priority\nMake edits based on reviews from peers and have the proposal ready for the instructor to review.\n\n\nProposal Instructor Review Edits\nAmit\nDone\n2025-06-20\nHigh Priority\nMake edits based on review from instructor to finalize the proposal.\n\n\nData Cleanup\nCat\nDone\n2025-06-19\nHigh Priority\nClean the dataset (handle missing values, outliers, formatting). Consult Amit for any major decisions on data handling.\n\n\nCreating New Variables\nAmit\nDone\n2025-06-19\nModerate Priority\nCreate derived variables for analysis based on research questions. Share variable definitions with Cat for feedback.\n\n\nCreating Draft of the Graph\nCat\nDone\n2025-06-21\nModerate Priority\nDevelop initial visualizations for the two research questions. Share drafts with Amit for input.\n\n\nMeeting to Discuss Graph Edits\nCat & Amit\nDone\n2025-06-21\nLow Priority\nMeet to review graph drafts, discuss improvements, and agree on final visualization approach.\n\n\nPolishing the Graph\nAmit\nDone\n2025-06-22\nModerate Priority\nRefine visualizations based on meeting feedback. Ensure clarity and alignment with research questions.\n\n\nWrite-Up of Analysis and Code\nCat\nDone\n2025-06-25\nModerate Priority\nWrite explanations for code and graphs, detailing methodology and findings. Amit reviews for clarity and accuracy.\n\n\nCreate Interactive PowerPoint\nAmit\nDone\n2025-06-27\nModerate Priority\nDesign an interactive PowerPoint presentation summarizing findings. Incorporate feedback from Cat on layout and content.\n\n\nFilm Presentation\nCat & Amit\nDone\n2025-06-29\nLow Priority\nJointly record the video presentation. Cat handles setup; Amit ensures script alignment with slides.\n\n\nEdit Presentation\nAmit\nDone\n2025-07-01\nLow Priority\nEdit the video for clarity and polish. Share with Cat for final approval before submission.\n\n\nProject Website\nAmit\nDone\n2025-07-02\nLow Priority\nPublish project website to GitHub with all the project components.\n\n\nFinal Project Submission\nCat & Amit\nTo-Do\n2025-07-02\nLow Priority\nMake any last minute changes and submit the final project with mutual sign-off from both the team members."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "",
    "text": "The Himalayan Database, a meticulous archive originating from the pioneering work of Elizabeth Hawley, provides an invaluable resource for understanding the history of mountaineering in the Nepal Himalaya. This project leverages a subset of this comprehensive database, specifically focusing on expedition data recorded between 2020 and 2024, to analyze key trends and influential factors in contemporary Himalayan climbing. Utilizing two tidy tibbles, ‘peaks’ and ‘expeditions,’ we investigate patterns related to seasonality, success rates, and national participation within this recent timeframe. Furthermore, the analysis delves into the relationships between critical expedition choices, such as selected routes and agency affiliations, and their impact on expedition outcomes, including success probabilities and fatality risks. By examining these variables across diverse nationalities and temporal periods within this focused dataset, this study aims to contribute a deeper, data-driven understanding of the multifaceted elements influencing mountaineering endeavors in the challenging Himalayan environment."
  },
  {
    "objectID": "index.html#abstract",
    "href": "index.html#abstract",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "",
    "text": "The Himalayan Database, a meticulous archive originating from the pioneering work of Elizabeth Hawley, provides an invaluable resource for understanding the history of mountaineering in the Nepal Himalaya. This project leverages a subset of this comprehensive database, specifically focusing on expedition data recorded between 2020 and 2024, to analyze key trends and influential factors in contemporary Himalayan climbing. Utilizing two tidy tibbles, ‘peaks’ and ‘expeditions,’ we investigate patterns related to seasonality, success rates, and national participation within this recent timeframe. Furthermore, the analysis delves into the relationships between critical expedition choices, such as selected routes and agency affiliations, and their impact on expedition outcomes, including success probabilities and fatality risks. By examining these variables across diverse nationalities and temporal periods within this focused dataset, this study aims to contribute a deeper, data-driven understanding of the multifaceted elements influencing mountaineering endeavors in the challenging Himalayan environment."
  },
  {
    "objectID": "index.html#introduction",
    "href": "index.html#introduction",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Introduction",
    "text": "Introduction\nMountaineering in the Nepal Himalaya represents one of humanity’s most profound engagements with extreme natural environments, characterized by unparalleled challenges and breathtaking achievements. Understanding the dynamics and outcomes of these expeditions is crucial for both historical context and future endeavors. This project embarks on an exploratory analysis of a specific segment of the rich historical data encapsulated within The Himalayan Database, an enduring legacy of Elizabeth Hawley’s dedicated efforts to document every facet of Himalayan climbing history. Originally compiled from a vast array of sources and made freely available online since 2017, the full database serves as a cornerstone for mountaineering research.\nOur study specifically focuses on intriguing patterns and insights derived from mountaineering expeditions undertaken in the Nepal Himalaya during the years 2020 to 2024. By analyzing this extensive, yet focused, dataset of Himalayan climbs—structured into ‘peaks’ and ‘expeditions’ tibbles—this project seeks to uncover significant relationships between the strategic choices climbers make—such as their selected routes and expedition agencies—and their chances of achieving success or facing the tragic risk of fatalities. The analysis particularly aims to shed light on how these critical factors vary across different nations and evolving time periods within this contemporary five-year window. Through this focused exploration of a recent subset of The Himalayan Database, we aspire to offer a deeper, data-driven understanding of what influences expedition outcomes in one of the world’s most challenging and captivating mountaineering environments."
  },
  {
    "objectID": "index.html#question-1",
    "href": "index.html#question-1",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Question 1",
    "text": "Question 1\nAre Certain Routes Favored by Expeditions from Particular Nations, and Do They Have Disparate Success Rates?\n\nIntroduction\nThis section initiates our investigation into the strategic choices made by mountaineering expeditions in the Nepal Himalaya and their correlation with expedition outcomes. Specifically, we aim to uncover whether the selection of particular climbing routes is influenced by the nationality of the expedition team. Furthermore, we will explore if these nationally-favored routes demonstrate significantly different success rates, potentially highlighting variations in national climbing philosophies, accumulated experience on specific routes, or inherent disparities in route difficulty. A crucial aspect of our analysis involves truncating low-volume attempts. This methodological decision is made to avoid the undue influence of statistical outliers that could arise from a small number of expeditions on a given route, ensuring that our insights are derived from more statistically robust patterns.\n\n\nApproach\nOur analytical approach to address this question is structured into three main phases:\n\n1. Peak-Specific Success Rate Calibration: To establish a foundational understanding, we first calibrated the general success rates for the top four most frequently attempted peaks within our 2020-2024 expeditions dataset. This step provides a broad overview of expedition success for these prominent summits, setting a comparative context for the more granular route-specific analysis.\n2. Visualization of Route Success by Nation: Following the general calibration, we proceeded to visualize the success percentages of popular chosen routes for each of these four peaks, broken down by the participating nations. A bubble chart was employed for this visualization. In these charts, the size of each bubble represents the volume of attempts by a specific nation on a particular route, while its position indicates the corresponding success percentage. This allows for a clear, intuitive representation of both the popularity and efficacy of routes across different national teams.\n3. Integrated Visualization and Interpretation: To facilitate a comprehensive comparative analysis and derive overarching interpretations, the individual bubble charts for all four peaks were combined into a single, integrated visualization. This unified view enables a direct comparison of route preferences and success rate disparities across multiple popular peaks and diverse national expedition teams, offering deeper insights into the interplay of national origin, route choice, and expedition success in the challenging Himalayan environment.\n\n\n\nAnalysis\n\nGeneral CensusEverestAma DablamLhotseManasluCombined 4 Bubble Chart Plots\n\n\ngeneral_census &lt;- ggplot(summary_data, aes(x = reorder(pkname, -attempts), y = success_rate, fill = attempts)) +\n  geom_col() +\n  geom_text(aes(label = success_rate_label),\n            vjust = -0.5,  # Position above bars\n            color = \"black\") +\n  scale_fill_viridis_c(\n    option = \"viridis\",\n    name = \"Number of Attempts\"\n  ) +\n  coord_cartesian(ylim = c(0, 100)) +  # Success rate is in percent (0-100)\n  labs(\n    x = \"Peaks\",\n    y = \"Success Rate (%)\",\n    title = \"Success Rate of Top 4 Peaks Attempted by all Nations\",\n    subtitle = \"Bar height indicates success rate; color indicates attempts\",\n    caption = \"Source: https://github.com/rfordatascience/tidytuesday\"\n  ) +\n  theme_minimal(base_size = 14)\n\n\np1 &lt;- ggplot(ever_top3, aes(x = route, y = success_rate_on_route)) +\n  geom_point(aes(color = attempts_on_route_per_nation, size = attempts_on_route_per_nation),\n             alpha = 0.7,\n             position = \"identity\") +\n  geom_text_repel(data = subset(ever_top3, attempts_on_route_per_nation &gt;= 1),\n                  aes(label = nation, color = attempts_on_route_per_nation),\n                  size = 5,\n                  box.padding = 0.7,\n                  point.padding = 0.6,\n                  min.segment.length = Inf) +\n  scale_color_viridis_c(option = \"turbo\",\n                        name = \"Attempts on Route\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = \"none\") +\n  scale_size_continuous(range = c(3, 15),\n                        name = \"Attempts on Route\",\n                        breaks = c(10, 20, 30),\n                        limits = c(0, 40),\n                        guide = \"none\")+\n  annotate(\"text\", y = 125, x = 0.7, label = \"Everest\", size = 5, fontface = \"bold\") +\n  labs(x = NULL,\n       y = \"Success Rate (%)\") +\n  scale_y_continuous(breaks = seq(0, 100, by = 25)) +\n  scale_x_discrete(labels = label_wrap(10)) +\n  coord_cartesian(ylim = c(-5, 125)) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(hjust = 0.5, size = 9),\n    legend.position = \"none\"\n  )\n\n\np2 &lt;- ggplot(amad_top3, aes(x = route, y = success_rate_on_route)) +\n  geom_point(aes(color = attempts_on_route_per_nation, size = attempts_on_route_per_nation),\n             alpha = 0.7,\n             position = position_jitter(width = 0)) +\n  geom_text_repel(data = subset(amad_top3, attempts_on_route_per_nation &gt;= 1),\n                  aes(label = nation, color = attempts_on_route_per_nation),\n                  size = 5,\n                  box.padding = 0.6,\n                  point.padding = 0.8,\n                  min.segment.length = Inf) +\n  scale_color_viridis_c(option = \"turbo\",\n                        name = \"Attempts on Route\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = \"none\") +\n  scale_size_continuous(range = c(3, 15),\n                        name = \"Attempts on Route\",\n                        breaks = c(10, 20, 30),\n                        limits = c(0, 40),\n                        guide = \"none\") +\n  annotate(\"text\", y = 120, x = 0.9, label = \"Ama Dablam\", size = 5, fontface = \"bold\") +\n  labs(x = NULL,\n       y = NULL) +\n  scale_y_continuous(breaks = seq(0, 100, by = 25)) + # Adjusted seq start to 0 for clarity\n  scale_x_discrete(labels = label_wrap(10)) +\n  coord_cartesian(ylim = c(-5, 120)) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(hjust = 0.5, size = 9),\n    legend.position = \"none\"\n  )\n\n\np3 &lt;- ggplot(lhot_top3, aes(x = route, y = success_rate_on_route)) +\n  geom_point(aes(color = attempts_on_route_per_nation, size = attempts_on_route_per_nation),\n             alpha = 0.6,\n             position = \"identity\") +\n  geom_text_repel(data = subset(lhot_top3, attempts_on_route_per_nation &gt;= 1),\n                  aes(label = nation, color = attempts_on_route_per_nation),\n                  size = 5,\n                  box.padding = 0.6,\n                  point.padding = 0.8,\n                  min.segment.length = Inf,\n                  position = \"identity\") +\n  scale_color_viridis_c(option = \"turbo\",\n                        name = \"Attempts on Route\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = \"none\") +\n  scale_size_continuous(range = c(3, 15),\n                        name = \"Attempts on Route\",\n                        breaks = c(10, 20, 30),\n                        limits = c(0, 40),\n                        guide = \"none\")+\n  annotate(\"text\", y = 130, x = 0.6, label = \"Lhotse\", size = 5, fontface = \"bold\") +\n  labs(x = \"Route\",\n       y = \"Success Rate (%)\") +\n  scale_y_continuous(breaks = seq(0, 100, by = 25)) +\n  scale_x_discrete(labels = label_wrap(10)) +\n  coord_cartesian(ylim = c(-5, 130)) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(hjust = 0.5, size = 9),\n    legend.position = \"none\"\n  )\n\n\np4 &lt;- ggplot(mana_top3, aes(x = route, y = success_rate_on_route)) +\n  geom_point(aes(color = attempts_on_route_per_nation, size = attempts_on_route_per_nation),\n             alpha = 0.7,\n             position = \"identity\") +\n  geom_text_repel(data = subset(mana_top3, attempts_on_route_per_nation &gt;= 1),\n                  aes(label = nation, color = attempts_on_route_per_nation),\n                  size = 5,\n                  box.padding = 0.6,\n                  point.padding = 0.8,\n                  min.segment.length = Inf,\n                  position = \"identity\") +\n  scale_color_viridis_c(option = \"turbo\",\n                        name = \"\\n\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = guide_colorbar(direction = \"horizontal\", title.position = \"top\")) +\n  scale_size_continuous(range = c(3, 15),\n                        name = \"                       Attempts on route metrix (size + color)\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = guide_legend(title.position = \"top\"))+\n  annotate(\"text\", y = 120, x = 0.55, label = \"Manaslu\", size = 5, fontface = \"bold\") +\n  labs (x = \"Route\",\n       y = NULL) +\n  scale_y_continuous(breaks = seq(0, 100, by = 25)) +\n  scale_x_discrete(labels = label_wrap(10)) +\n  coord_cartesian(ylim = c(-5, 120)) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(hjust = 0.5, size = 9),\n    legend.position = \"none\"\n  )\n\n\ncombined_plot &lt;- (p1 + p2) / (p3 + p4) +\n  plot_layout(guides = \"collect\") +\n  plot_annotation(\n    title = \"National Route Preferences and Success Rates\\nin High-Altitude Peak Expeditions (2020-2024)\",\n    subtitle = \"Bubble Size and Color Show Attempts, with Success Rates\\nfor Top 3 Nations Across Four Most Popular Peaks\",\n    caption = \"Source: https://github.com/rfordatascience/tidytuesday\",\n    theme = theme(\n      plot.title = element_text(face = \"bold\", size = 18, hjust = 0.2),\n      plot.subtitle = element_text(size = 14, hjust = 0.2),\n      plot.caption = element_text(size = 14)\n    )\n  ) &\n  theme(\n    legend.position = \"bottom\",\n    legend.box = \"horizontal\",\n    legend.title.align = 0.5,\n    #legend.margin = margin(t = 5, b = 5),\n    legend.title = element_text(size = 14)\n  )\n\n\n\n\n\nVisualization\n\nGeneral Census PlotNational Route Preference and Success Rate Plot\n\n\n\n\n\n\n\n\n\n\n\nAlt text: Bar chart titled “Success Rate of Top 4 Peaks Attempted by all Nations (2020-2024)” showing success rates for Everest (88.9%), Ama Dablam (93.2%), Lhotse (88.9%), and Manaslu (52.6%). Bar height indicates success rate, with colors ranging from yellow (180 attempts) to dark purple (100 attempts) representing the number of attempts. Source: https://github.com/rfordatascience/tidytuesday.\n\n\n\n\n\n\n\n\n\n\n\nAlt text: Bubble chart titled “National Route Preferences and Success Rates in High-Altitude Peak Expeditions (2020-2024)” showing success rates for top 3 nations across four popular peaks: Everest, Ama Dablam, Lhotse, and Manaslu. Bubbles represent attempts, with size and color indicating the number of attempts (1 to 40), and position showing success rates (0-100%). Routes include N Col-NE Ridge, N Face (Hornbein Couloir), S Col-SE Ridge for Everest; SW Ridge, W Face for Ama Dablam; S Col-W Face, W Face for Lhotse; and NE Face for Manaslu. Nations include USA, China, Nepal, India, and UK. Source: https://github.com/rfordatascience/tidytuesday.\n\n\n\n\n\nObservation\nThe combined bubble plots for Everest, Lhotse, Ama Dablam, and Manaslu reveal clear patterns in national route preferences and their corresponding success rates:\n\nDominant Route Concentration: A significant majority of expedition attempts across these popular peaks are concentrated on a single, well-established route. For instance, the “S Col-SE Ridge” on Everest and the “W Face” on Lhotse are overwhelmingly favored, indicated by large bubbles representing high attempt volumes from nations like the USA, China, and Nepal. This suggests the existence of a ‘standard’ or ‘commercial’ route for each peak.\nMarginality of Alternate Routes: While other routes were attempted, their popularity and often their success rates were considerably lower. Smaller bubbles and, at times, lower success percentages for alternative paths (e.g., Everest’s “N Col-NE Ridge”) highlight a strong collective preference for the primary, more established route, with alternatives attracting fewer expeditions.\nStrategic Path-Peak Selection: The data strongly indicates that route selection is a critical determinant of expedition success, particularly for top-performing nations. Countries like the USA, China, Nepal, and India consistently favor specific path-peak combinations that demonstrate high success rates. This strategic alignment underscores a pragmatic approach where route choice is a calculated decision to optimize success probabilities.\nConfirmation of Inherent Route Bias: The observed patterns in the 2020-2024 dataset reinforce a historical trend where specific routes have emerged as the most reliable. The high success rates for concentrated attempts on routes like Everest’s “S Col-SE Ridge” reflect a continuing bias towards ‘proven’ paths, likely due to well-documented passages, established infrastructure, and accumulated experience, which collectively contribute to a higher probability of success."
  },
  {
    "objectID": "index.html#question-2",
    "href": "index.html#question-2",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Question 2",
    "text": "Question 2"
  },
  {
    "objectID": "index.html#conclusion-limitations-and-future-directions",
    "href": "index.html#conclusion-limitations-and-future-directions",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Conclusion, Limitations, and Future Directions",
    "text": "Conclusion, Limitations, and Future Directions\n\nConclusion\nOur analysis of 2020-2024 Himalayan expeditions reveals that the overwhelmingly dominant and historically proven routes are consistently preferred and yield the highest success rates. Top-performing nations strategically prioritize these established paths, underscoring route selection as a critical determinant of expedition success. Conversely, alternative routes demonstrate notably lower effectiveness.\nAdditionally, if you go on a Himalayan expedition, don’t do so with Seven Summit Treks in the Spring\n\n\nKey Limitations\nOur analysis faced two primary limitations:\n\nData Quality: The initial dataset required significant pre-processing due to inconsistencies, particularly with consolidated route information, impacting granular analysis.\nData Sparsity: A high variable count relative to the number of entries in our filtered dataset limited the ability to draw universally conclusive findings and complex statistical relationships.\n\n\n\nFuture Directions\nBuilding on these insights, future research should focus on:\n\nIn-depth Dataset Exploration: Leveraging the comprehensive original Himalayan Database (https://www.himalayandatabase.com/hbn2019.html) to conduct more robust analyses and explore broader historical trends.\nExpanded Variable Analysis: Investigating a wider range of factors, such as leadership roles, team sizes, and seasonal influences.\nPredictive Modeling: Developing models to forecast expedition success based on various input factors, aiding future planning and risk management."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "This project was developed by [Chawala-Xia] For INFO 526 - Data Analysis and Visualization at the University of Arizona, taught by Dr. Greg Chism. The team is comprised of the following team members.\n\nAmit Chawla, continuing with his 1st year at University of Arizona, enrolled in Masters in Data Science Program (online) .\nCat Xia"
  },
  {
    "objectID": "presentation.html#introduction",
    "href": "presentation.html#introduction",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Introduction",
    "text": "Introduction\nThis project explores intriguing patterns and insights into mountaineering expeditions in the Nepal Himalaya.\n\nBy analyzing an extensive dataset of Himalayan climbs, the project seeks to uncover relationships between the choices climbers make: -\n— such as their selected routes and expedition agencies.\n— and their chances of success or risk of fatalities.\nThe analysis particularly aims to shed light on how these factors vary across different nations and time periods, offering a deeper understanding of what influences expedition outcomes in one of the world’s most challenging environments."
  },
  {
    "objectID": "presentation.html#the-himalayan-database",
    "href": "presentation.html#the-himalayan-database",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "The Himalayan Database",
    "text": "The Himalayan Database\n\nContains the History of Himalayan Mountaineering Expeditions from Tidytuesday, taken from the archive of Elizabeth Hawley on ‘The Himalayan Dataset’.\nDetails peaks, expeditions, expedition related aspects, outcomes, and geographic data.\nAnalysis uses two tidy tibbles: peaks and expeditions.\nNote: Expeditions dataset filtered to years 2020–2024 for manageable file size."
  },
  {
    "objectID": "presentation.html#question-1-1",
    "href": "presentation.html#question-1-1",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Question 1:",
    "text": "Question 1:\nAre certain routes favored by expeditions from particular nations, and do they have disparate success rates?\n\n\nIntroduction:\n\nThe idea is to find out if there is any affect on success or failure based on the chosen route.\nAnalysis truncates the low volume attempts to avoid outliers.\n\n\nApproach:\n\nFirst I have calibrated the general census of top 4 peaks attempted by nations, to identify the general success rate of the peak.\nNext, visualized each peak and success percentage of popular chosen routes by nation, in a bubble chart.\nTo finalize, the visualization and derive interpretation. I combined all 4 charts in one."
  },
  {
    "objectID": "presentation.html#general-census",
    "href": "presentation.html#general-census",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "General Census",
    "text": "General Census\n\n\nThe general census shows that 3 out of top 4 peaks attempted for expedition shows fairly positive results around 90% success rate.\n\nNow we will see what role does choice of route plays here…."
  },
  {
    "objectID": "presentation.html#plot-analysis",
    "href": "presentation.html#plot-analysis",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Plot Analysis",
    "text": "Plot Analysis\n\n\nWarning: The `legend.title.align` argument of `theme()` is deprecated as of ggplot2\n3.5.0.\nℹ Please use theme(legend.title = element_text(hjust)) instead."
  },
  {
    "objectID": "presentation.html#observations",
    "href": "presentation.html#observations",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Observations",
    "text": "Observations\n\nDominant Route Preference: A significant majority of attempts concentrated on a single, well-established route for this peak.\nMarginal Alternate Success: While other routes were attempted, their success rates or popularity were considerably lower, highlighting a clear preference for the primary path.\nStrategic Path-Peak Selection: Top-performing nations consistently favored a specific path-peak combination, indicating that route selection is a critical determinant of expedition success.\nInherent Route Bias: The observed pattern reflects a historical trend where a particular route, proven over years, emerged as the most reliable for success by 2020-2024 dataset."
  },
  {
    "objectID": "presentation.html#agencies-that-have-at-least-1-fatal-expedition-between-2021-2024",
    "href": "presentation.html#agencies-that-have-at-least-1-fatal-expedition-between-2021-2024",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Agencies that have at least 1 fatal expedition between 2021-2024",
    "text": "Agencies that have at least 1 fatal expedition between 2021-2024"
  },
  {
    "objectID": "presentation.html#zoom-in-2021",
    "href": "presentation.html#zoom-in-2021",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Zoom In: 2021",
    "text": "Zoom In: 2021\n\n2021 Percent Deaths2021 Actual Deaths"
  },
  {
    "objectID": "presentation.html#zoom-in-2022",
    "href": "presentation.html#zoom-in-2022",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Zoom In: 2022",
    "text": "Zoom In: 2022\n\n2022 Percent Deaths2022 Actual Deaths"
  },
  {
    "objectID": "presentation.html#zoom-in-2023",
    "href": "presentation.html#zoom-in-2023",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Zoom In: 2023",
    "text": "Zoom In: 2023\n\n2023 Percent Deaths2023 Total Deaths"
  },
  {
    "objectID": "presentation.html#zoom-in-2024",
    "href": "presentation.html#zoom-in-2024",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Zoom In: 2024",
    "text": "Zoom In: 2024\n\n2024 Percent Deaths2024 Total Deaths"
  },
  {
    "objectID": "presentation.html#observations-1",
    "href": "presentation.html#observations-1",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Observations",
    "text": "Observations\n\nSeven Summit Trekks had the most expeditions that had at least one fatality but often were not the most fatal per individual treks, and had low percentage of fatalities for each expedition.\nSpring was significantly more deadly than Autumn\n2022 and 2023 had more deaths than 2021 and 2024\nSlightly more Hiker fatality than Staff fatality"
  },
  {
    "objectID": "presentation.html#key-limitations",
    "href": "presentation.html#key-limitations",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Key Limitations",
    "text": "Key Limitations\n\nData Quality: Initial dataset required extensive cleanup due to inconsistencies (e.g., consolidated route information in one column instead of four).\nData Sparsity: High variable count relative to entries limited conclusive findings."
  },
  {
    "objectID": "presentation.html#future-directions",
    "href": "presentation.html#future-directions",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Future Directions",
    "text": "Future Directions\n\nIn-depth Dataset Exploration: Our team intends to expand our analysis by leveraging the more comprehensive data available in the original dataset’s second edition, accessible at: https://www.himalayandatabase.com/hbn2019.html This will enable a deeper investigation into the insights observed in the current smaller dataset."
  },
  {
    "objectID": "presentation.html#conclusion",
    "href": "presentation.html#conclusion",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Conclusion",
    "text": "Conclusion\n\nThe overwhelmingly dominant and historically proven route is the preferred and most successful path for this peak, with top-performing nations consistently prioritizing it due to its critical role in expedition success. Alternate routes are notably less effective.\nIf you go on a Himalayan expedition, don’t do so with Seven Summit Treks in the Spring"
  },
  {
    "objectID": "presentation.html#images",
    "href": "presentation.html#images",
    "title": "Analytical Visualization on the History of Himalyan Expeditions",
    "section": "Images",
    "text": "Images\n\nImage credit: Raimond Klavins, Unsplash Royalty Free Images."
  },
  {
    "objectID": "Q1-Sol.html",
    "href": "Q1-Sol.html",
    "title": "Q1 Solution",
    "section": "",
    "text": "if (!require(\"pacman\")) \n  install.packages(\"pacman\")\n\npacman::p_load(tidyverse,\n               janitor,\n               scales,\n               stringr,\n               ggthemes,\n               ggrepel,\n               patchwork,\n               grid)\n\n# set theme for ggplot2\nggplot2::theme_set(ggplot2::theme_minimal(base_size = 20))\n\n# set width of code output\noptions(width = 65)\n\n# set figure parameters for knitr\nknitr::opts_chunk$set(\n  fig.width = 11, # 11\" width\n  fig.asp = 0.618, # the golden ratio\n  fig.retina = 3, # dpi multiplier for displaying HTML output on retina\n  fig.align = \"center\", # center align figures\n  dpi = 300 # higher dpi, sharper image\n)\n\n\ntuesdata &lt;- tidytuesdayR::tt_load('2025-01-21')\n\nexped_tidy &lt;- tuesdata$exped_tidy\npeaks_tidy &lt;- tuesdata$peaks_tidy\n\n\nexped_tidy_cleaned &lt;- clean_names(exped_tidy)\npeaks_tidy_cleaned &lt;- clean_names(peaks_tidy)\n\npivoted_data &lt;- exped_tidy_cleaned |&gt;\n  pivot_longer(\n    cols = c(route1, route2, route3, route4, success1, success2, success3, success4),\n    names_to = c(\".value\", \"index\"),\n    names_pattern = \"(route|success)(\\\\d+)\"\n  )\n\npivoted_data &lt;- pivoted_data |&gt;\n  filter(!is.na(route))\n\npivoted_data &lt;- pivoted_data |&gt;\n  mutate(route = str_replace_all(route, \"S Col SE Ridge\", \"S Col-SE Ridge\"))\n\nsummary_data &lt;- pivoted_data |&gt;\n  group_by(peakid) |&gt;\n  summarize(\n    attempts = n(),\n    success_rate = (mean(success, na.rm = TRUE) * 100), # This remains NUMERIC for fill aesthetic\n    .groups = 'drop' # Good practice to drop grouping after summarize\n  ) |&gt;\n  arrange(desc(attempts)) |&gt;\n  slice_head(n = 4)\n\n# Create a SEPARATE column for the label, formatted as a character string\nsummary_data$success_rate_label &lt;- sprintf(\"%.1f%%\", summary_data$success_rate)\n\n# Join with peaks_tidy_cleaned to get peak names, keeping original peakid\nsummary_data &lt;- summary_data |&gt;\n  left_join(select(peaks_tidy_cleaned, peakid, pkname), by = \"peakid\")\n\nggplot(summary_data, aes(x = reorder(pkname, -attempts), y = success_rate, fill = attempts)) +\n  geom_col() +\n  geom_text(aes(label = success_rate_label),\n            vjust = -0.5,  # Position above bars\n            color = \"black\") +\n  scale_fill_viridis_c(\n    option = \"viridis\",\n    name = \"Number of Attempts\"\n  ) +\n  coord_cartesian(ylim = c(0, 100)) +  # Success rate is in percent (0-100)\n  labs(\n    x = \"Peaks\",\n    y = \"Success Rate (%)\",\n    title = \"Success Rate of Top 4 Peaks Attempted by all Nations\",\n    subtitle = \"Bar height indicates success rate; color indicates attempts\",\n    caption = \"Source: https://github.com/rfordatascience/tidytuesday\"\n  ) +\n  theme_minimal(base_size = 14)\n\n\n\n\n\n\n\n\n\nselected_peaks &lt;- c(\"EVER\", \"AMAD\", \"LHOT\", \"MANA\", \"HIML\")\n\npivoted_data_cleaned &lt;- pivoted_data |&gt;\n  filter(!is.na(route) & !is.na(nation))\n\nsummary_data_with_combined_key &lt;- pivoted_data_cleaned |&gt;\n  group_by(peakid, route, nation) |&gt;\n  summarize(\n    attempts_on_route_per_nation = n(),\n    success_rate_on_route = (mean(success, na.rm = TRUE) * 100),\n    .groups = 'drop'\n  ) |&gt;\n  mutate(peakid_route = paste(peakid, route, sep = \" - \")) |&gt;\n  arrange(peakid, route, desc(attempts_on_route_per_nation))\n\never_df &lt;- summary_data_with_combined_key |&gt;\n  filter(peakid == 'EVER')\n\n# Calculate total attempts per nation across all routes\ntotal_attempts &lt;- ever_df |&gt;\n  group_by(nation)|&gt;\n  summarise(total_attempts = sum(attempts_on_route_per_nation)) |&gt;\n  slice_max(order_by = total_attempts, n = 3)\n\n# Get the top 3 nations\ntop_nations &lt;- total_attempts$nation\n\n# Filter the dataframe to include only the top 3 nations\never_top3 &lt;- ever_df |&gt; \n  filter(nation %in% top_nations)\n\nprint(ever_top3)\n\n# A tibble: 6 × 6\n  peakid route                     nation attempts_on_route_per…¹\n  &lt;chr&gt;  &lt;chr&gt;                     &lt;chr&gt;                    &lt;int&gt;\n1 EVER   N Col-NE Ridge            China                        9\n2 EVER   N Col-NE Ridge            USA                          2\n3 EVER   N Face (Hornbein Couloir) USA                          1\n4 EVER   S Col-SE Ridge            Nepal                       39\n5 EVER   S Col-SE Ridge            USA                         31\n6 EVER   S Col-SE Ridge            China                       11\n# ℹ abbreviated name: ¹​attempts_on_route_per_nation\n# ℹ 2 more variables: success_rate_on_route &lt;dbl&gt;,\n#   peakid_route &lt;chr&gt;\n\n# Create the bubble chart\np1 &lt;- ggplot(ever_top3, aes(x = route, y = success_rate_on_route)) +\n  geom_point(aes(color = attempts_on_route_per_nation, size = attempts_on_route_per_nation),\n             alpha = 0.7,\n             position = \"identity\") +\n  geom_text_repel(data = subset(ever_top3, attempts_on_route_per_nation &gt;= 1),\n                  aes(label = nation, color = attempts_on_route_per_nation),\n                  size = 5,\n                  box.padding = 0.7,\n                  point.padding = 0.6,\n                  min.segment.length = Inf) +\n  scale_color_viridis_c(option = \"turbo\",\n                        name = \"Attempts on Route\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = \"none\") +\n  scale_size_continuous(range = c(3, 15),\n                        name = \"Attempts on Route\",\n                        breaks = c(10, 20, 30),\n                        limits = c(0, 40),\n                        guide = \"none\")+\n  annotate(\"text\", y = 125, x = 0.7, label = \"Everest\", size = 5, fontface = \"bold\") +\n  labs(x = NULL,\n       y = \"Success Rate (%)\") +\n  scale_y_continuous(breaks = seq(0, 100, by = 25)) +\n  scale_x_discrete(labels = label_wrap(10)) +\n  coord_cartesian(ylim = c(-5, 125)) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(hjust = 0.5, size = 9),\n    legend.position = \"none\"\n  )\n\n\namad_df &lt;- summary_data_with_combined_key |&gt;\n  filter(peakid == 'AMAD')\n\n# Calculate total attempts per nation across all routes\ntotal_attempts &lt;- amad_df |&gt;\n  group_by(nation)|&gt;\n  summarise(total_attempts = sum(attempts_on_route_per_nation)) |&gt;\n  slice_max(order_by = total_attempts, n = 3)\n\n# Get the top 3 nations\ntop_nations &lt;- total_attempts$nation\n\n# Filter the dataframe to include only the top 3 nations\namad_top3 &lt;- amad_df |&gt; \n  filter(nation %in% top_nations)\n\nprint(amad_top3)\n\n# A tibble: 5 × 6\n  peakid route    nation attempts_on_route_per_nation\n  &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;                         &lt;int&gt;\n1 AMAD   N Ridge  USA                               1\n2 AMAD   SW Ridge USA                              23\n3 AMAD   SW Ridge UK                               21\n4 AMAD   SW Ridge Nepal                            11\n5 AMAD   W Face   Nepal                             1\n# ℹ 2 more variables: success_rate_on_route &lt;dbl&gt;,\n#   peakid_route &lt;chr&gt;\n\n# Create the bubble chart\np2 &lt;- ggplot(amad_top3, aes(x = route, y = success_rate_on_route)) +\n  geom_point(aes(color = attempts_on_route_per_nation, size = attempts_on_route_per_nation),\n             alpha = 0.7,\n             position = position_jitter(width = 0)) +\n  geom_text_repel(data = subset(amad_top3, attempts_on_route_per_nation &gt;= 1),\n                  aes(label = nation, color = attempts_on_route_per_nation),\n                  size = 5,\n                  box.padding = 0.6,\n                  point.padding = 0.8,\n                  min.segment.length = Inf) +\n  scale_color_viridis_c(option = \"turbo\",\n                        name = \"Attempts on Route\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = \"none\") +\n  scale_size_continuous(range = c(3, 15),\n                        name = \"Attempts on Route\",\n                        breaks = c(10, 20, 30),\n                        limits = c(0, 40),\n                        guide = \"none\") +\n  annotate(\"text\", y = 120, x = 0.9, label = \"Ama Dablam\", size = 5, fontface = \"bold\") +\n  labs(x = NULL,\n       y = NULL) +\n  scale_y_continuous(breaks = seq(0, 100, by = 25)) + # Adjusted seq start to 0 for clarity\n  scale_x_discrete(labels = label_wrap(10)) +\n  coord_cartesian(ylim = c(-5, 120)) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(hjust = 0.5, size = 9),\n    legend.position = \"none\"\n  )\n\n\nlhot_df &lt;- summary_data_with_combined_key |&gt;\n  filter(peakid == 'LHOT')\n\n# Calculate total attempts per nation across all routes\ntotal_attempts &lt;- lhot_df |&gt;\n  group_by(nation)|&gt;\n  summarise(total_attempts = sum(attempts_on_route_per_nation)) |&gt;\n  slice_max(order_by = total_attempts, n = 3)\n\n# Get the top 3 nations\ntop_nations &lt;- total_attempts$nation\n\n# Filter the dataframe to include only the top 3 nations\nlhot_top3 &lt;- lhot_df |&gt; \n  filter(nation %in% top_nations)\n\nprint(lhot_top3)\n\n# A tibble: 6 × 6\n  peakid route        nation attempts_on_route_per_nation\n  &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;                         &lt;int&gt;\n1 LHOT   S Col-W Face USA                              11\n2 LHOT   S Col-W Face India                             7\n3 LHOT   S Col-W Face Nepal                             6\n4 LHOT   W Face       Nepal                            11\n5 LHOT   W Face       India                            10\n6 LHOT   W Face       USA                               9\n# ℹ 2 more variables: success_rate_on_route &lt;dbl&gt;,\n#   peakid_route &lt;chr&gt;\n\n# Create the bubble chart\np3 &lt;- ggplot(lhot_top3, aes(x = route, y = success_rate_on_route)) +\n  geom_point(aes(color = attempts_on_route_per_nation, size = attempts_on_route_per_nation),\n             alpha = 0.6,\n             position = \"identity\") +\n  geom_text_repel(data = subset(lhot_top3, attempts_on_route_per_nation &gt;= 1),\n                  aes(label = nation, color = attempts_on_route_per_nation),\n                  size = 5,\n                  box.padding = 0.6,\n                  point.padding = 0.8,\n                  min.segment.length = Inf,\n                  position = \"identity\") +\n  scale_color_viridis_c(option = \"turbo\",\n                        name = \"Attempts on Route\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = \"none\") +\n  scale_size_continuous(range = c(3, 15),\n                        name = \"Attempts on Route\",\n                        breaks = c(10, 20, 30),\n                        limits = c(0, 40),\n                        guide = \"none\")+\n  annotate(\"text\", y = 130, x = 0.6, label = \"Lhotse\", size = 5, fontface = \"bold\") +\n  labs(x = \"Route\",\n       y = \"Success Rate (%)\") +\n  scale_y_continuous(breaks = seq(0, 100, by = 25)) +\n  scale_x_discrete(labels = label_wrap(10)) +\n  coord_cartesian(ylim = c(-5, 130)) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(hjust = 0.5, size = 9),\n    legend.position = \"none\"\n  )\n\n\nmana_df &lt;- summary_data_with_combined_key |&gt;\n  filter(peakid == 'MANA')\n\n# Calculate total attempts per nation across all routes\ntotal_attempts &lt;- mana_df |&gt;\n  group_by(nation)|&gt;\n  summarise(total_attempts = sum(attempts_on_route_per_nation)) |&gt;\n  slice_max(order_by = total_attempts, n = 3)\n\n# Get the top 3 nations\ntop_nations &lt;- total_attempts$nation\n\n# Filter the dataframe to include only the top 3 nations\nmana_top3 &lt;- mana_df |&gt; \n  filter(nation %in% top_nations)\n\nprint(mana_top3)\n\n# A tibble: 4 × 6\n  peakid route   nation attempts_on_route_per_nation\n  &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;                         &lt;int&gt;\n1 MANA   NE Face Nepal                            20\n2 MANA   NE Face USA                              10\n3 MANA   NE Face China                             6\n4 MANA   NE Face UK                                6\n# ℹ 2 more variables: success_rate_on_route &lt;dbl&gt;,\n#   peakid_route &lt;chr&gt;\n\n# Create the bubble chart\np4 &lt;- ggplot(mana_top3, aes(x = route, y = success_rate_on_route)) +\n  geom_point(aes(color = attempts_on_route_per_nation, size = attempts_on_route_per_nation),\n             alpha = 0.7,\n             position = \"identity\") +\n  geom_text_repel(data = subset(mana_top3, attempts_on_route_per_nation &gt;= 1),\n                  aes(label = nation, color = attempts_on_route_per_nation),\n                  size = 5,\n                  box.padding = 0.6,\n                  point.padding = 0.8,\n                  min.segment.length = Inf,\n                  position = \"identity\") +\n  scale_color_viridis_c(option = \"turbo\",\n                        name = \"\\n\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = guide_colorbar(direction = \"horizontal\", title.position = \"top\")) +\n  scale_size_continuous(range = c(3, 15),\n                        name = \"                       Attempts on route metrix (size + color)\",\n                        breaks = c(1, 10, 20, 30, 40),\n                        limits = c(0, 40),\n                        guide = guide_legend(title.position = \"top\"))+\n  annotate(\"text\", y = 120, x = 0.55, label = \"Manaslu\", size = 5, fontface = \"bold\") +\n  labs (x = \"Route\",\n       y = NULL) +\n  scale_y_continuous(breaks = seq(0, 100, by = 25)) +\n  scale_x_discrete(labels = label_wrap(10)) +\n  coord_cartesian(ylim = c(-5, 120)) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(hjust = 0.5, size = 9),\n    legend.position = \"none\"\n  )\n\n\n# Combine plots with patchwork\ncombined_plot &lt;- (p1 + p2) / (p3 + p4) +\n  plot_layout(guides = \"collect\") +\n  plot_annotation(\n    title = \"National Route Preferences and Success Rates\\nin High-Altitude Peak Expeditions (2020-2024)\",\n    subtitle = \"Bubble Size and Color Show Attempts, with Success Rates\\nfor Top 3 Nations Across Four Most Popular Peaks\",\n    caption = \"Source: https://github.com/rfordatascience/tidytuesday\",\n    theme = theme(\n      plot.title = element_text(face = \"bold\", size = 18, hjust = 0.2),\n      plot.subtitle = element_text(size = 14, hjust = 0.2),\n      plot.caption = element_text(size = 14)\n    )\n  ) &\n  theme(\n    legend.position = \"bottom\",\n    legend.box = \"horizontal\",\n    legend.title.align = 0.5,\n    #legend.margin = margin(t = 5, b = 5),\n    legend.title = element_text(size = 14)\n  )\n\nplot(combined_plot)"
  }
]